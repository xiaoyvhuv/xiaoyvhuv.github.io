<!doctype html><html lang=zh><head><meta name=viewport content="width=device-width,initial-scale=1"><title>计算机网络面试题汇总与解析：三次握手与四次挥手</title>
<meta charset=utf-8><meta name=description content="Ladder@Hello! &#x1f44b;在网络通信和面试场景中，TCP协议的三次握手与四次挥手是必考的核心知识点。本文从面试题角度出发，结合底层原理和实际场景，整理高频问题并提供深度解析。"><meta name=author content="I'm 邢思宇"><link rel=canonical href=https://xiaoyvhuv.github.io/blog/first/><link rel=alternate type=application/rss+xml href=https://xiaoyvhuv.github.io//index.xml title="XingSiyv'sBlog"><script async defer data-website-id=ec55b2da-4f55-45ef-8aed-26e57078fd15 src=https://umami-jlwf.vercel.app/hugo-ladder></script><meta property="og:url" content="https://xiaoyvhuv.github.io/blog/first/"><meta property="og:site_name" content="XingSiyv'sBlog"><meta property="og:title" content="计算机网络面试题汇总与解析：三次握手与四次挥手"><meta property="og:description" content="Hello! 👋在网络通信和面试场景中，TCP协议的三次握手与四次挥手是必考的核心知识点。本文从面试题角度出发，结合底层原理和实际场景，整理高频问题并提供深度解析。"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-02-06T12:03:30+08:00"><meta property="article:modified_time" content="2025-02-06T12:03:30+08:00"><meta property="article:tag" content="前端"><meta name=twitter:card content="summary"><meta name=twitter:title content="计算机网络面试题汇总与解析：三次握手与四次挥手"><meta name=twitter:description content="Hello! 👋在网络通信和面试场景中，TCP协议的三次握手与四次挥手是必考的核心知识点。本文从面试题角度出发，结合底层原理和实际场景，整理高频问题并提供深度解析。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://xiaoyvhuv.github.io/blog/"},{"@type":"ListItem","position":2,"name":"计算机网络面试题汇总与解析：三次握手与四次挥手","item":"https://xiaoyvhuv.github.io/blog/first/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"计算机网络面试题汇总与解析：三次握手与四次挥手","name":"计算机网络面试题汇总与解析：三次握手与四次挥手","description":"Hello! \u0026#x1f44b;在网络通信和面试场景中，TCP协议的三次握手与四次挥手是必考的核心知识点。本文从面试题角度出发，结合底层原理和实际场景，整理高频问题并提供深度解析。\n","keywords":["前端"],"articleBody":"Hello! 👋在网络通信和面试场景中，TCP协议的三次握手与四次挥手是必考的核心知识点。本文从面试题角度出发，结合底层原理和实际场景，整理高频问题并提供深度解析。\n一、基础概念与流程 1. 三次握手过程 问题：请描述TCP三次握手的具体流程。\n答案：\nSYN：客户端发送SYN=1, seq=x报文，进入SYN_SENT状态。 SYN-ACK：服务端返回SYN=1, ACK=1, seq=y, ack=x+1，进入SYN_RCVD状态。 ACK：客户端发送ACK=1, seq=x+1, ack=y+1，双方进入ESTABLISHED状态。 解析：\n核心目标：同步初始序列号（ISN），确保双方收发能力正常。 为何是三次？ 避免历史重复连接的初始化（如延迟的旧SYN报文），同时确保双方确认彼此的收发能力。 2. 四次挥手过程 问题：为什么断开连接需要四次挥手？\n答案：\nFIN：主动关闭方（如客户端）发送FIN=1，进入FIN_WAIT_1。 ACK：被动关闭方（如服务端）返回ACK，进入CLOSE_WAIT，客户端进入FIN_WAIT_2。 FIN：服务端处理完数据后发送FIN=1，进入LAST_ACK。 ACK：客户端返回ACK后进入TIME_WAIT，服务端关闭。 解析：\n四次的原因：TCP是全双工协议，需双方独立关闭通道。被动方可能需要时间处理剩余数据，因此ACK和FIN分开发送。 TIME_WAIT的作用：确保最后一个ACK能被接收（防止因丢包导致服务端重传FIN），同时让旧连接的报文在网络中消散（2MSL时间）。 二、高频进阶问题 1. 握手时SYN洪泛攻击是什么？如何防御？ 答案：\n攻击原理：攻击者伪造大量SYN报文但不回复ACK，耗尽服务端资源（半连接队列）。 防御手段： 启用SYN Cookie机制（通过哈希计算验证请求合法性，不占用队列）。 限制半连接队列大小或缩短SYN超时时间。 2. 大量CLOSE_WAIT状态的可能原因？ 答案：\n现象：服务端存在大量CLOSE_WAIT状态连接。 原因：应用程序未正确调用close()方法，导致服务端无法发送FIN报文。 解决：检查代码逻辑（如未关闭Socket、线程阻塞等）。 3. 握手阶段能否携带数据？ 答案：\n第三次握手可以携带数据：此时连接已建立，客户端确认服务端的收发能力。 前两次不能：若SYN报文携带数据，可能被恶意攻击者利用（如放大攻击）。 4. TIME_WAIT状态为什么要等待2MSL？ 答案：\nMSL（Maximum Segment Lifetime）：报文最大生存时间（通常30秒-2分钟）。 2MSL的意义： 确保被动方的FIN重传能被响应（若ACK丢失，被动方会重发FIN）。 让旧连接的报文在网络中失效，避免与新连接冲突。 三、实战场景与异常分析 1. 服务端出现大量TIME_WAIT连接怎么办？ 答案：\n原因：短连接频繁创建和关闭（如HTTP短连接）。 优化方案： 使用长连接（如HTTP Keep-Alive）。 修改内核参数（如net.ipv4.tcp_tw_reuse和net.ipv4.tcp_tw_recycle，需谨慎）。 2. 第二次握手丢失会发生什么？ 答案：\n客户端行为：超时后重传SYN报文（指数退避）。 服务端行为：未收到ACK，停留在SYN_RCVD状态，直到超时丢弃连接。 3. 如果服务端直接断电，TCP连接如何关闭？ 答案：\n无FIN报文：客户端通过心跳机制（如Keep-Alive）检测到连接失效，主动发送RST复位连接。 未启用心跳：客户端可能长时间保持ESTABLISHED状态，直到应用层超时。 四、总结与面试技巧 理解状态转换图：熟记TCP的11种状态（如SYN_SENT、TIME_WAIT）及转换条件。 结合实际场景：如高并发下的连接管理、服务器参数调优。 扩展知识：对比UDP的无连接特性，理解TCP的可靠性设计（如序列号、超时重传）。 面试提示：回答时结合抓包工具（Wireshark）分析握手/挥手过程，展示动手能力。\n通过掌握三次握手与四次挥手的底层逻辑和异常处理，不仅能应对面试，更能为实际网络问题排查打下坚实基础。\n","wordCount":"85","inLanguage":"zh","datePublished":"2025-02-06T12:03:30+08:00","dateModified":"2025-02-06T12:03:30+08:00","author":{"@type":"Person","name":"I'm 邢思宇"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaoyvhuv.github.io/blog/first/"},"publisher":{"@type":"Organization","name":"XingSiyv'sBlog","logo":{"@type":"ImageObject","url":"https://xiaoyvhuv.github.io/favicon.ico"}}}</script><link rel=icon href=/images/xiaoyv.png sizes=16x16><link rel=apple-touch-icon href=/images/xiaoyv.png><link rel=manifest href=/images/xiaoyv.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css><link rel=stylesheet href=/css/main.min.ec28f09e946fc0df77c187fcd0d0ebde58fca6de8efb8e1620f3d45c32d4da88.css integrity="sha256-7CjwnpRvwN93wYf80NDr3lj8pt6O+44WIPPUXDLU2og=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>主页
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/blog/>文章</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/archive/>项目</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/contact/>联系</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=https://umami-jlwf.vercel.app/share/ZKhEVgh56RlSfAMa/baize1998.github.io>网站统计</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/xiaoyvhuv><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-social"><a class=navigation-link href="https://space.bilibili.com/672236811?spm_id_from=333.1007.0.0"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tv"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>计算机网络面试题汇总与解析：三次握手与四次挥手</h1></header><p><small>2025年2月6日&nbsp;· 85 字&nbsp;· 1 分钟</small><p><div class=blog-toc><nav id=TableOfContents><ul><li><ul><li><a href=#一基础概念与流程>一、基础概念与流程</a></li><li><a href=#二高频进阶问题>二、高频进阶问题</a></li><li><a href=#三实战场景与异常分析>三、实战场景与异常分析</a></li><li><a href=#四总结与面试技巧>四、总结与面试技巧</a></li></ul></li></ul></nav></div><section class=blog-content><p>Hello! &#x1f44b;在网络通信和面试场景中，TCP协议的三次握手与四次挥手是必考的核心知识点。本文从面试题角度出发，结合底层原理和实际场景，整理高频问题并提供深度解析。</p><hr><h3 id=一基础概念与流程>一、基础概念与流程</h3><h4 id=1-三次握手过程><strong>1. 三次握手过程</strong></h4><p><strong>问题</strong>：请描述TCP三次握手的具体流程。<br><strong>答案</strong>：</p><ol><li><strong>SYN</strong>：客户端发送<code>SYN=1, seq=x</code>报文，进入<code>SYN_SENT</code>状态。</li><li><strong>SYN-ACK</strong>：服务端返回<code>SYN=1, ACK=1, seq=y, ack=x+1</code>，进入<code>SYN_RCVD</code>状态。</li><li><strong>ACK</strong>：客户端发送<code>ACK=1, seq=x+1, ack=y+1</code>，双方进入<code>ESTABLISHED</code>状态。</li></ol><p><strong>解析</strong>：</p><ul><li><strong>核心目标</strong>：同步初始序列号（ISN），确保双方收发能力正常。</li><li><strong>为何是三次？</strong> 避免历史重复连接的初始化（如延迟的旧SYN报文），同时确保双方确认彼此的收发能力。</li></ul><hr><h4 id=2-四次挥手过程><strong>2. 四次挥手过程</strong></h4><p><strong>问题</strong>：为什么断开连接需要四次挥手？<br><strong>答案</strong>：</p><ol><li><strong>FIN</strong>：主动关闭方（如客户端）发送<code>FIN=1</code>，进入<code>FIN_WAIT_1</code>。</li><li><strong>ACK</strong>：被动关闭方（如服务端）返回<code>ACK</code>，进入<code>CLOSE_WAIT</code>，客户端进入<code>FIN_WAIT_2</code>。</li><li><strong>FIN</strong>：服务端处理完数据后发送<code>FIN=1</code>，进入<code>LAST_ACK</code>。</li><li><strong>ACK</strong>：客户端返回<code>ACK</code>后进入<code>TIME_WAIT</code>，服务端关闭。</li></ol><p><strong>解析</strong>：</p><ul><li><strong>四次的原因</strong>：TCP是全双工协议，需双方独立关闭通道。被动方可能需要时间处理剩余数据，因此ACK和FIN分开发送。</li><li><strong>TIME_WAIT的作用</strong>：确保最后一个ACK能被接收（防止因丢包导致服务端重传FIN），同时让旧连接的报文在网络中消散（2MSL时间）。</li></ul><hr><h3 id=二高频进阶问题>二、高频进阶问题</h3><h4 id=1-握手时syn洪泛攻击是什么如何防御><strong>1. 握手时SYN洪泛攻击是什么？如何防御？</strong></h4><p><strong>答案</strong>：</p><ul><li><strong>攻击原理</strong>：攻击者伪造大量SYN报文但不回复ACK，耗尽服务端资源（半连接队列）。</li><li><strong>防御手段</strong>：<ul><li>启用<code>SYN Cookie</code>机制（通过哈希计算验证请求合法性，不占用队列）。</li><li>限制半连接队列大小或缩短SYN超时时间。</li></ul></li></ul><hr><h4 id=2-大量close_wait状态的可能原因><strong>2. 大量CLOSE_WAIT状态的可能原因？</strong></h4><p><strong>答案</strong>：</p><ul><li><strong>现象</strong>：服务端存在大量<code>CLOSE_WAIT</code>状态连接。</li><li><strong>原因</strong>：应用程序未正确调用<code>close()</code>方法，导致服务端无法发送FIN报文。</li><li><strong>解决</strong>：检查代码逻辑（如未关闭Socket、线程阻塞等）。</li></ul><hr><h4 id=3-握手阶段能否携带数据><strong>3. 握手阶段能否携带数据？</strong></h4><p><strong>答案</strong>：</p><ul><li><strong>第三次握手可以携带数据</strong>：此时连接已建立，客户端确认服务端的收发能力。</li><li><strong>前两次不能</strong>：若SYN报文携带数据，可能被恶意攻击者利用（如放大攻击）。</li></ul><hr><h4 id=4-time_wait状态为什么要等待2msl><strong>4. TIME_WAIT状态为什么要等待2MSL？</strong></h4><p><strong>答案</strong>：</p><ul><li><strong>MSL（Maximum Segment Lifetime）</strong>：报文最大生存时间（通常30秒-2分钟）。</li><li><strong>2MSL的意义</strong>：<ul><li>确保被动方的FIN重传能被响应（若ACK丢失，被动方会重发FIN）。</li><li>让旧连接的报文在网络中失效，避免与新连接冲突。</li></ul></li></ul><hr><h3 id=三实战场景与异常分析>三、实战场景与异常分析</h3><h4 id=1-服务端出现大量time_wait连接怎么办><strong>1. 服务端出现大量TIME_WAIT连接怎么办？</strong></h4><p><strong>答案</strong>：</p><ul><li><strong>原因</strong>：短连接频繁创建和关闭（如HTTP短连接）。</li><li><strong>优化方案</strong>：<ul><li>使用长连接（如HTTP Keep-Alive）。</li><li>修改内核参数（如<code>net.ipv4.tcp_tw_reuse</code>和<code>net.ipv4.tcp_tw_recycle</code>，需谨慎）。</li></ul></li></ul><hr><h4 id=2-第二次握手丢失会发生什么><strong>2. 第二次握手丢失会发生什么？</strong></h4><p><strong>答案</strong>：</p><ul><li><strong>客户端行为</strong>：超时后重传SYN报文（指数退避）。</li><li><strong>服务端行为</strong>：未收到ACK，停留在<code>SYN_RCVD</code>状态，直到超时丢弃连接。</li></ul><hr><h4 id=3-如果服务端直接断电tcp连接如何关闭><strong>3. 如果服务端直接断电，TCP连接如何关闭？</strong></h4><p><strong>答案</strong>：</p><ul><li><strong>无FIN报文</strong>：客户端通过心跳机制（如Keep-Alive）检测到连接失效，主动发送RST复位连接。</li><li><strong>未启用心跳</strong>：客户端可能长时间保持<code>ESTABLISHED</code>状态，直到应用层超时。</li></ul><hr><h3 id=四总结与面试技巧>四、总结与面试技巧</h3><ol><li><strong>理解状态转换图</strong>：熟记TCP的11种状态（如<code>SYN_SENT</code>、<code>TIME_WAIT</code>）及转换条件。</li><li><strong>结合实际场景</strong>：如高并发下的连接管理、服务器参数调优。</li><li><strong>扩展知识</strong>：对比UDP的无连接特性，理解TCP的可靠性设计（如序列号、超时重传）。</li></ol><p><strong>面试提示</strong>：回答时结合抓包工具（Wireshark）分析握手/挥手过程，展示动手能力。</p><hr><p>通过掌握三次握手与四次挥手的底层逻辑和异常处理，不仅能应对面试，更能为实际网络问题排查打下坚实基础。</p></section></article></div><footer class=footer><p>&copy; 2025 <a href=https://xiaoyvhuv.github.io/>XingSiyv'sBlog</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>